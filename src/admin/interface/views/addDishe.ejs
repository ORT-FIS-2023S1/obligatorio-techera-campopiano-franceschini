<!-- Contenido de agregarPlato -->
<!-- Aquí puedes incluir el contenido específico de agregarPlato -->
<!-- Por ejemplo, puedes incluir el formulario -->
<div class="container">
  <div class="row">
    <div class="col-md-4">
      <div class="continer">
        <h1>Agregar Plato al Menú</h1>
        <form id="plato-form" action="/admin/index/addDishe" method="POST">
          <div class="form-group">
            <label for="name">Nombre del Plato:</label>
            <input
              type="text"
              id="name"
              name="name"
              class="form-control"
              required
            />
          </div>
          <div class="form-group">
            <label for="price">Precio del Plato:</label>
            <input
              type="text"
              id="price"
              name="price"
              class="form-control"
              required
            />
          </div>
          <div class="form-group">
            <label for="ingredients">Ingredientes principales:</label>
            <input
              type="text"
              id="ingredients"
              name="ingredients"
              class="form-control"
              required
            />
          </div>
          <div class="form-group">
            <label for="portions">Tamaño de la porción:</label>
            <input
              type="text"
              id="portions"
              name="portions"
              class="form-control"
              required
            />
          </div>
          <div class="form-group">
            <label for="nutritionalInformation">Información Nutricional:</label>
            <textarea
              id="nutritionalInformation"
              name="nutritionalInformation"
              class="form-control"
              rows="5"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="imageURL">URL de la Imágen:</label>
            <input
              type="text"
              id="imageURL"
              name="imageURL"
              class="form-control"
              required
            />
          </div>
          <div class="button-container">
            <button type="submit" class="btn btn-primary">Agregar Plato</button>
            <button type="button" class="btn btn-secondary cancel">
              Cancelar
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="col-md-6">
      <h1>Lista de Platos Disponibles</h1>
      <% let j=0 %> <% if (dishes && dishes.length > 0) { %>
      <ol class="ol" style="--length: 5" role="list">
        <% for (let i = 0; i < dishes.length; i++) { const dishe = dishes[i];
        j++; %>
        <li class="li" style="--i: <%=j%>">
          <h2 class="h3"><%= dishe.name %></h2>
          <p class="p">Ingredientes: <%= dishe.ingredients %></p>
          <p class="p">Porción: <%= dishe.portions %></p>
          <p class="p">Info Nutricional: <%= dishe.nutritionalInformation %></p>
          <p class="p">Precio: $<%= dishe.price %></p>
          <img
            class="product-image"
            src="<%= dishe.imageURL %>"
            alt="Imagen del producto"
          />
        </li>
        <% } %>
      </ol>
      <% } else { %>
      <div class="center">
        <div class="notification warning">
          <i class="fa-solid fa-exclamation"></i>
          <span>No se han agregado platos aún.</span>
        </div>
      </div>
      <% } %>
    </div>
  </div>
  <script>
    // Obtener el formulario y los campos
    const form = document.getElementById("plato-form");

    // Manejar el evento de envío del formulario
    form.addEventListener("submit", function (event) {
      event.preventDefault(); // Evitar que el formulario se envíe

      // Obtener los valores de los campos
      //const formData = new FormData(form);

      // Realizar una solicitud AJAX al servidor para guardar los datos del formulario
      fetch(form.action, {
        method: form.method,
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
        body: new URLSearchParams(new FormData(form)),
      })
        .then((response) => {
          if (response.ok) {
            // Se guardaron los datos exitosamente
            Swal.fire({
              icon: "success",
              title: "Plato agregado",
              text: "El plato ha sido agregado correctamente al menú",
              showCancelButton: true,
              confirmButtonText: "Agregar otro plato",
              cancelButtonText: "Ir al inicio",
            }).then((result) => {
              if (result.isConfirmed) {
                // El usuario quiere agregar otro plato
                // Limpiar los campos del formulario
                form.reset();
                location.reload();
              } else {
                // El usuario quiere ir al inicio
                // Redirigir al usuario a la página de inicio
                window.location.href = "/admin/index"; // Reemplaza '/inicio' con la ruta de la página de inicio en tu aplicación
              }
            });
          } else {
            throw new Error("Error al guardar los datos del formulario");
          }
        })
        .catch((error) => {
          console.error(error);
          // Manejar el error de alguna manera, por ejemplo, mostrar un mensaje de error con Swal
          Swal.fire({
            icon: "error",
            title: "Error",
            text: "Ocurrió un error al guardar los datos del formulario.",
          });
        });
    });
  </script>
</div>
